# secure-api.shouvik.dev http
server {
    listen 80;
    server_name secure-api.shouvik.dev;
    # status_zone secure-api.shouvik.dev_http;

    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name secure-api.shouvik.dev "";
    # status_zone secure-api.shouvik.dev_https;

    # SSL Certificate details to enable HTTPS
    ssl_certificate /etc/ssl/CF-origin.crt;
    ssl_certificate_key /etc/ssl/CF-origin.key;

    location / {
        proxy_pass http://vampi_upstream;

        # Below two lines are to enable keepalive connections
        proxy_http_version 1.1;
        proxy_set_header Connection "";
    }

    # # Below location block is for configuring Active Healthchecks
    #  location @health_check {
    #          internal;            # Requests by NGINX only
    #          proxy_set_header Host vampi.shouvik.dev;
    #          proxy_pass http://vampi_upstream;
    #          health_check interval=5s fails=3 passes=2 uri=/ match=status_ok;

    #          # Health check logs are boring but errors are interesting
    #          access_log  /var/log/nginx/health_check.log  main;
    #          access_log off;
    #          error_log  /var/log/nginx/error.log error;
    #  }
}